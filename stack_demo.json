[
{"title": "\"Avoid an excessive DOM size\" How to reduce DOM size in react JS?", "link": "https://stackoverflow.com/questions/72846027/avoid-an-excessive-dom-size-how-to-reduce-dom-size-in-react-js", "tags": ["javascript", "reactjs", "dom"], "total_answers": 3, "details": [], "asked_by": {"name": "Yuvraj Chaudhari", "user-profile-link": "https://stackoverflow.com/users/15351923/yuvraj-chaudhari", "asked-time": "Jul 3, 2022 at 11:16", "reputation": "241", "gold": "2", "silver": "5", "bronze": "10"}, "answer": [{"content": "Some suggestions from PageSpeed/Lighthouse may not be feasible or necessary for every site. It should be used as part of the overall performance picture, but not as the only decision-making criteria. 4000+ DOM nodes may or may not be acceptable, depending on the web application.\nReal-world performance is more important. Instead of focusing solely on PageSpeed scores, prioritize improving the actual experience for users.\nIn general, look for ways to create DOM nodes only when needed, and destroy nodes when they're no longer needed.\nIf you're shipping a large DOM tree, try loading your page and manually noting which nodes are displayed. Perhaps you can remove the undisplayed nodes from the initially loaded document and only create them after a relevant user interaction, such as a scroll or a button click.\nUse a library like react-window to minimize the number of DOM nodes created if you are rendering many repeated elements on the page.\nReference:\nhttps://developer.chrome.com/docs/lighthouse/performance/dom-size", "is_accepted": false, "answered_by": {"name": "y0u", "user-profile-link": "https://stackoverflow.com/users/9276777/y0u", "answered_time": "16 hours ago", "reputation": "1", "gold": "0", "silver": "0", "bronze": "1"}}, {"content": "Following libraries might be useful depending on your use case:\nTanStack Virtual\nreact-virtualized\nreact-infinite-scroller\nReact Window\nVirtuoso\nIn case you are looking for help with\n, you can check out  :\nhttps://www.npmjs.com/package/react-window\nCode Sandbox Demo Link :\nhttps://codesandbox.io/s/5wqo7z2np4", "is_accepted": false, "answered_by": {"name": "Kartik Gupta", "user-profile-link": "https://stackoverflow.com/users/13835323/kartik-gupta", "answered_time": "12 mins ago", "reputation": "33", "gold": "0", "silver": "0", "bronze": "6"}}, {"content": "Generally, this error occurs when you try to write a lot of content in a single component.\nand\nthose components depending on your specific need.\nhttps://blog.bitsrc.io/lazy-loading-react-components-with-react-lazy-and-suspense-f05c4cfde10c", "is_accepted": false, "answered_by": {"name": "abhijeetgurle", "user-profile-link": "https://stackoverflow.com/users/8922765/abhijeetgurle", "answered_time": "Jul 3, 2022 at 12:09", "reputation": "805", "gold": "0", "silver": "7", "bronze": "11"}}]},
{"title": "Laravel 10 CORS issue fix", "link": "https://stackoverflow.com/questions/79302587/laravel-10-cors-issue-fix", "tags": ["cors", "laravel-10"], "total_answers": 1, "details": [], "asked_by": {"name": "Bhawesh Bhaskar", "user-profile-link": "https://stackoverflow.com/users/7618456/bhawesh-bhaskar", "asked-time": "53 mins ago", "reputation": "42", "gold": "0", "silver": "0", "bronze": "6"}, "answer": [{"content": "Your domain is probably missing from the Access-Control-Allow-Origin header of the third-party IPs you are retrieving data from, which is why the CORS issue occurs. It is unfortunately a drawback of the browser's CORS enforcement.", "is_accepted": false, "answered_by": {"name": "Ethun Hunt", "user-profile-link": "https://stackoverflow.com/users/28576527/ethun-hunt", "answered_time": "12 mins ago", "reputation": "1", "gold": "0", "silver": "0", "bronze": "3"}}]},
{"title": "Polars successive joins alternative", "link": "https://stackoverflow.com/questions/79299528/polars-successive-joins-alternative", "tags": ["python", "python-polars", "polars"], "total_answers": 1, "details": [], "asked_by": {"name": "jqurious", "user-profile-link": "https://stackoverflow.com/users/19355181/jqurious", "asked-time": "yesterday", "reputation": "20.6k", "gold": "4", "silver": "19", "bronze": "35"}, "answer": [{"content": "Maybe using a list and indices to access the data can be faster than the coalesce / when.\nsymbol_to_idx = dict(pl.DataFrame(list_symbols, schema=['symbol']).with_row_index().select('symbol', 'index').iter_rows())\n(\n    df.join(basket, on=\"symbol\", how=\"left\")\n    # alternative #2 to the successive joins \n    .join(\n        df_pivot.select(\n            \"date\", \n            pl.concat_list(list_symbols).alias(\"price_to_drop\")\n        ),\n        on=\"date\",\n        how=\"left\",\n    )\n    .with_columns([col(f'symbol_{i}').replace(symbol_to_idx).alias(f'symbol_index_{i}_to_drop') for i in [1,2]])\n    .with_columns(*[col('price_to_drop').list.get(col(f'symbol_index_{i}_to_drop')).alias(f'price_{i}') for i in [1,2]])\n    .select(pl.exclude(\"^.*to_drop$\"))\n)", "is_accepted": false, "answered_by": {"name": "randomcoder877", "user-profile-link": "https://stackoverflow.com/users/23274857/randomcoder877", "answered_time": "10 mins ago", "reputation": "45", "gold": "0", "silver": "0", "bronze": "6"}}]},
{"title": "Is it possible to filter woocommerce product tags programmatically?", "link": "https://stackoverflow.com/questions/79302446/is-it-possible-to-filter-woocommerce-product-tags-programmatically", "tags": ["php", "woocommerce"], "total_answers": 1, "details": [], "asked_by": {"name": "funguy", "user-profile-link": "https://stackoverflow.com/users/385917/funguy", "asked-time": "2 hours ago", "reputation": "2,162", "gold": "7", "silver": "30", "bronze": "42"}, "answer": [{"content": "This worked:\nfunction filter_product_tags_with_debug($terms, $post_id, $taxonomy) {\nif ($taxonomy == 'product_tag') {\n    // Define the unwanted tag slugs (more than one tag)\n    $unwanted_tag_slugs = ['themostunwanted', 'shop-by-birthday-gift-tote-bag', 'yetanotherunwantedtag'];\n\n    // Filter out the unwanted tags from the array of terms\n    foreach ($terms as $key => $term) {\n        // Check if the term's slug is in the unwanted list\n        if (in_array($term->slug, $unwanted_tag_slugs)) {\n            unset($terms[$key]);\n        }\n    }\n\n    // Log the filtered terms to the browser console for debugging\n //   console_log($terms);\n}\nreturn $terms;\n}\nadd_filter('get_the_terms', 'filter_product_tags_with_debug', 10, 3);", "is_accepted": false, "answered_by": {"name": "funguy", "user-profile-link": "https://stackoverflow.com/users/385917/funguy", "answered_time": "9 mins ago", "reputation": "2,162", "gold": "7", "silver": "30", "bronze": "42"}}]},
{"title": "How to process and update (change attribute, add node, etc) XML file with a DOCTYPE in Python, without removing nor altering the \"DOCTYPE\"", "link": "https://stackoverflow.com/questions/79302542/how-to-process-and-update-change-attribute-add-node-etc-xml-file-with-a-doct", "tags": ["python", "xml", "xml-parsing", "dtd", "doctype"], "total_answers": 1, "details": [], "asked_by": {"name": "fascynacja", "user-profile-link": "https://stackoverflow.com/users/2695990/fascynacja", "asked-time": "1 hour ago", "reputation": "2,776", "gold": "5", "silver": "27", "bronze": "51"}, "answer": [{"content": "I think the stripping of the prefix in the doctype is no failure. If you really like the prefix you can write it explictly:\ndef replace_checksum_in_index_xml(infile, checksum_new, outfile):\n    parser = etree.XMLParser(remove_blank_text=True)\n    with open(infile, \"rb\") as f:\n        tree = etree.parse(f, parser)\n\n    for elem in tree.xpath(\"//to[@checksum]\"):\n        elem.set(\"checksum\", checksum_new)\n\n    with open(outfile, \"wb\") as f:\n        f.write('<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\\n'.encode('utf8'))\n        f.write('<!DOCTYPE note:note SYSTEM \"note.dtd\">\\n'.encode('utf8'))\n        tree.write(f, pretty_print=True, xml_declaration=False, encoding=\"UTF-8\")", "is_accepted": false, "answered_by": {"name": "Hermann12", "user-profile-link": "https://stackoverflow.com/users/12621346/hermann12", "answered_time": "8 mins ago", "reputation": "3,376", "gold": "2", "silver": "7", "bronze": "19"}}]},
{"title": "Get cookie in Blazor .NET 8 before first render", "link": "https://stackoverflow.com/questions/77817590/get-cookie-in-blazor-net-8-before-first-render", "tags": ["asp.net-core", "cookies", "blazor", "signalr", "blazor-server-side"], "total_answers": 3, "details": [], "asked_by": {"name": "Ruikai Feng", "user-profile-link": "https://stackoverflow.com/users/18177989/ruikai-feng", "asked-time": "Jan 17 at 6:34", "reputation": "11.2k", "gold": "1", "silver": "6", "bronze": "15"}, "answer": [{"content": "You may try:\n@page \"/\"\n@inject StateContainer StateContainer\n@inject PersistentComponentState ApplicationState\n\n<PageTitle>Home</PageTitle>\n\n<h1>Hello, world!</h1>\n\nCookieVal:@data\n\n@code{\n\n    [CascadingParameter]\n\n    public HttpContext? httpContext { get; set; }\n\n    private string data;\n\n    private PersistingComponentStateSubscription persistingSubscription;\n\n\n    protected override void OnInitialized()\n    {\n        StateContainer.OnChange += StateHasChanged;\n        if (httpContext is not null)\n        {\n\n            var existTargetCookie = httpContext.Request.Cookies.TryGetValue(\"CookieKey\", out data);\n        }\n        else\n        {\n            if(ApplicationState.TryTakeFromJson<string>(\n            \"Cookie\", out data))\n            {\n                StateContainer.Property = data;\n            }\n            else\n            {\n                data = StateContainer.Property;\n            }\n        }\n        persistingSubscription =\n        ApplicationState.RegisterOnPersisting(PersistData);\n    }\n\n    private Task PersistData()\n    {\n        ApplicationState.PersistAsJson(\"Cookie\", data);\n\n        return Task.CompletedTask;\n    }\n\n\n\n    public void Dispose()\n    {\n        persistingSubscription.Dispose();\n        StateContainer.OnChange -= StateHasChanged;\n    }\n    \n}\n\n\npublic class StateContainer\n{\n    private string? savedString;\n\n    public string Property\n    {\n        get => savedString ?? string.Empty;\n        set\n        {\n            savedString = value;\n            NotifyStateChanged();\n        }\n    }\n\n    public event Action? OnChange;\n\n    private void NotifyStateChanged() => OnChange?.Invoke();\n}\nResult:", "is_accepted": false, "answered_by": {"name": "Ruikai Feng", "user-profile-link": "https://stackoverflow.com/users/18177989/ruikai-feng", "answered_time": "Jan 15 at 10:16", "reputation": "11.2k", "gold": "1", "silver": "6", "bronze": "15"}}, {"content": "I figured out a workaround. Injecting the state container directly into the\nApp\ncomponent never worked out for me; it always instantiates in non-user-scope and never re-initializes, so the persist pattern is not viable.\nEventually I just stored the cookie as a regular member of the App component and transferred it by normal parameter binding to a child component. That child component does render in user-scope, so I was able to inject the state container there.\nIt's not as clean and reusable as I would have liked, but at least it works.", "is_accepted": true, "answered_by": {"name": "Ola Berntsson", "user-profile-link": "https://stackoverflow.com/users/3734747/ola-berntsson", "answered_time": "Feb 23 at 22:13", "reputation": "1,116", "gold": "1", "silver": "11", "bronze": "24"}}, {"content": "In Blazor .NET 8 Interactive WebAssembly with prerendering enabled, HTTP requests made in OnAfterRenderAsync will include the cookie request header.\nE.g.\nprivate List<PersonVM>? PeopleList { get; set; }\n\n[Inject]\nHttpClient httpClient { get; set; } = default!;\n\nprotected override async Task OnAfterRenderAsync(bool firstRender)\n{\n    if (firstRender)\n    {\n        await GetData();\n    }\n}\n\nprivate async Task GetData()\n{\n    var response = await httpClient.GetFromJsonAsync<List<PersonVM>>(\"api/data/getpeoplelist\");\n    PeopleList = response ?? new List<PersonVM>();\n    StateHasChanged();\n}", "is_accepted": false, "answered_by": {"name": "F Snyman", "user-profile-link": "https://stackoverflow.com/users/2749695/f-snyman", "answered_time": "8 mins ago", "reputation": "509", "gold": "1", "silver": "5", "bronze": "6"}}]},
{"title": "SQuirrelL SQL and H2 Database", "link": "https://stackoverflow.com/questions/79297869/squirrell-sql-and-h2-database", "tags": ["h2", "squirrel-sql"], "total_answers": 1, "details": [], "asked_by": {"name": "CodeKiller", "user-profile-link": "https://stackoverflow.com/users/8363841/codekiller", "asked-time": "8 mins ago", "reputation": "89", "gold": "5", "silver": "1", "bronze": "8"}, "answer": [{"content": "First you can create a session using:\njdbc:h2:D:/TEMP/H2-test;MODE=Oracle;DB_CLOSE_DELAY=-1\nthis should create a session to a database on\nD:\\TEMP\\\nD:\\TEMP> dir H2*.*\n Volume in drive D is HDD\n Volume Serial Number is D46B-804B\n\n Directory of D:\\TEMP\n\n23-12-2024  09:54                 0 H2-test.mv.db\n23-12-2024  09:55                 0 H2-test.trace.db\nIn the SQL prompt of SQuireL-SQL, you then enter (you might need to do refresh before seeing this):\nCREATE SCHEMA TEST;\nThis will create a schema with name\nTEST\n:\nNow you can edit the session and add\n;SCHEMA=TEST\nConnecting using this session defaults to the schema\nTEST\n.\nLike:\nand:", "is_accepted": false, "answered_by": {"name": "Luuk", "user-profile-link": "https://stackoverflow.com/users/724039/luuk", "answered_time": "21 mins ago", "reputation": "14.8k", "gold": "5", "silver": "26", "bronze": "40"}}]},
{"title": "Fastest way to homogenize a list", "link": "https://stackoverflow.com/questions/79302463/fastest-way-to-homogenize-a-list", "tags": ["python-3.x", "algorithm", "sorting"], "total_answers": 3, "details": [], "asked_by": {"name": "greybeard", "user-profile-link": "https://stackoverflow.com/users/3789665/greybeard", "asked-time": "20 mins ago", "reputation": "2,426", "gold": "9", "silver": "37", "bronze": "70"}, "answer": [{"content": "First, we will prove that\n.\nSuppose the homogenized list with a target number\nx\nthat isn't in the list is a minimum steps solution. We check the difference with each number\na[i]\nand the required step is\nsum(min(abs(x-a[i]), a[i]))\n(We define this as\ns1\n).\nThen we consider target number\nx-1\nand the required steps becomes\nsum(min(abs(x-1-a[i]), a[i]))\n(We define this as\ns2\n).\nWe compare\ns1\nand\ns2\n:\ns1 = s2\ns2 < s1\ns1\ns2 > s1\nx + 1\nx\nThen we check every number in the list as a target number and calculate the required steps, then we can get the minimum steps in\nO(n^2)\ntime complexity.", "is_accepted": false, "answered_by": {"name": "Sayalic", "user-profile-link": "https://stackoverflow.com/users/1291716/sayalic", "answered_time": "55 mins ago", "reputation": "7,632", "gold": "10", "silver": "65", "bronze": "118"}}, {"content": "The optimal solution isn't always the median. Instead, we need to try every possible target value between the minimum and maximum numbers in the list.\nFor each potential target value, we need to consider two options for each number:\nThe algorithm should choose the cheaper option for each number.\nThe total cost for a given target value is the sum of the optimal choices for each number.\nWe then pick the target value that gives us the minimum total cost.", "is_accepted": false, "answered_by": {"name": "kay", "user-profile-link": "https://stackoverflow.com/users/13277058/kay", "answered_time": "1 hour ago", "reputation": "51", "gold": "0", "silver": "0", "bronze": "7"}}, {"content": "You can solve this problem in linear time for small integer lists (using counting sort), and in\nO(n log(n))\ntime larger value lists.\nFirst, lets handle signed values. The target value of the array with be zero, negative, or positive. If its zero, the min is just the sum of the array values. If its positive, all of the negative values are closer to zero, so their contribution to the overall score will just be the absolute value of their sum. We can then handle the sublist of just positive values (and vice versa for the negative case).\nTo find the min solution for a strictly positive list, we can first sort the list, and then incrementally remove the smallest values from the list, marking them as going-to-zero, and as such adding their numeric value to the score. For the rest of the items, we just calculate the median, and determine the total deviation from the median across the rest of the items. If we do this calculation carefully, we can get each median with constant time, calculate the combined (summed) deviation from the median on the sublist of remaining elements in constant time, and can overall compute the minimum score in linear time (not counting the initial sorting).\nIn code, we just sort the list, compute cumulative sums, compute medians, and then iterate through plugging and chugging the math to calculate the score for each partitioning. Here is python code that does this:\nfrom itertools import accumulate\n\ndef solve_pos(nums):\n    if not nums:\n        return 0\n        \n    nums = sorted(nums, reverse=True)\n    csums = list(accumulate(nums[::-1]))[::-1] + [0]\n    medians = [nums[i // 2] for i in range(len(csums))]\n\n    def score(size, median):\n        mid = size // 2\n        total = csums[0] - 2 * csums[mid] + 2 * csums[size]\n        total -= median * (2 * mid - size)\n        return total\n\n    return min(score(size, median)\n               for size, median in zip(range(len(csums)), medians))\n\ndef solve(nums):\n    neg = [x for x in nums if x < 0]\n    pos = [x for x in nums if x > 0]\n\n    return min(sum(map(abs, nums)),\n           -sum(neg) + solve_pos(nums),\n            sum(pos) + solve_pos([-x for x in neg]))\nIn python this will be\nO(n log n)\ndue to the implementation of the sorting function, however you may be able to use counting sort based on your examples, which would make it\nO(n)\nof course. Additionally, if you know your list is going to be non-negative, you can strip most of that wrapper logic to handle the negative case.", "is_accepted": false, "answered_by": {"name": "Dillon Davis", "user-profile-link": "https://stackoverflow.com/users/6221024/dillon-davis", "answered_time": "6 mins ago", "reputation": "7,711", "gold": "2", "silver": "16", "bronze": "40"}}]},
{"title": "XSL-FO dynamic table column width", "link": "https://stackoverflow.com/questions/14877194/xsl-fo-dynamic-table-column-width", "tags": ["pdf-generation", "xsl-fo", "multiple-columns", "apache-fop"], "total_answers": 4, "details": [], "asked_by": {"name": "SeanWM", "user-profile-link": "https://stackoverflow.com/users/1476763/seanwm", "asked-time": "Feb 14, 2013 at 14:37", "reputation": "17k", "gold": "9", "silver": "53", "bronze": "84"}, "answer": [{"content": "Unfortunately I didn't find a simple way to have dynamic column widths. I ended up with this:\n<fo:table-column column-number=\"1\"  column-width=\"35pt\" />\n<fo:table-column column-number=\"2\"  />\n<fo:table-column column-number=\"3\"  />\n<fo:table-column column-number=\"4\"  />\n<fo:table-column column-number=\"5\"  />\n<fo:table-column column-number=\"6\"  />\n<fo:table-column column-number=\"7\"  />\n<fo:table-column column-number=\"8\"  />\n<fo:table-column column-number=\"9\"  />\n<fo:table-column column-number=\"10\" />\n<fo:table-column column-number=\"11\" />\n<fo:table-column column-number=\"12\" />\nI specify the first column because the data will never change. The rest I leave open to fit their content. Works the way I need it to work for now.", "is_accepted": true, "answered_by": {"name": "SeanWM", "user-profile-link": "https://stackoverflow.com/users/1476763/seanwm", "answered_time": "Feb 14, 2013 at 16:41", "reputation": "17k", "gold": "9", "silver": "53", "bronze": "84"}}, {"content": "You can also specify the units in \"percent units\". Works fine for me...\n<fo:table-column column-number=\"1\" column-width=\"75%\" /> \n<fo:table-column column-number=\"2\" column-width=\"25%\" />", "is_accepted": false, "answered_by": {"name": "Raman Sahasi", "user-profile-link": "https://stackoverflow.com/users/2815219/raman-sahasi", "answered_time": "Dec 31, 2015 at 5:56", "reputation": "31.8k", "gold": "9", "silver": "62", "bronze": "73"}}, {"content": "Ex-1 :\n<fo:table-column column-number=\"1\" column-width=\"proportional-column-width(3)\"/>\n<fo:table-column column-number=\"2\"/>\n<fo:table-column column-number=\"3\"/>\nEx-2 :\n<fo:table-column column-number=\"1\" column-width=\"proportional-column-width(3)\"/>\n<fo:table-column column-number=\"2\" column-width=\"proportional-column-width(4)\"/>\n<fo:table-column column-number=\"3\"/>", "is_accepted": false, "answered_by": {"name": "slfan", "user-profile-link": "https://stackoverflow.com/users/599668/slfan", "answered_time": "Sep 26, 2017 at 8:00", "reputation": "9,118", "gold": "115", "silver": "68", "bronze": "81"}}, {"content": "<fo:table-column column-number=\"1\" column-width=\"auto\"> which is not working. It gives some default width.. I just wanted to make it auto based on the content in the table column", "is_accepted": false, "answered_by": {"name": "Ganga", "user-profile-link": "https://stackoverflow.com/users/28902922/ganga", "answered_time": "6 mins ago", "reputation": "1", "gold": "0", "silver": "0", "bronze": "0"}}]},
{"title": "How to use dependency injection in WinForms", "link": "https://stackoverflow.com/questions/70475830/how-to-use-dependency-injection-in-winforms", "tags": ["c#", ".net", "winforms", "dependency-injection"], "total_answers": 5, "details": [], "asked_by": {"name": "Reza Aghaei", "user-profile-link": "https://stackoverflow.com/users/3110834/reza-aghaei", "asked-time": "Dec 24, 2021 at 22:10", "reputation": "125k", "gold": "18", "silver": "230", "bronze": "426"}, "answer": [{"content": "To use DI in a WinForms .NET 5 or 6 you can do the following steps:\nCreate a WinForms .NET Application\nInstall Microsoft.Extensions.Hosting package (which gives you a bunch of useful features like DI, Logging, Configurations, and etc.)\nAdd a new interface,\nIHelloService.cs\n:\npublic interface IHelloService\n{\n    string SayHello();\n}\nAdd a new implementation for your service\nHelloService.cs\n:\npublic class HelloService : IHelloService\n{\n    public string SayHello()\n    {\n        return \"Hello, world!\";\n    }\n}\nModify the\nProgram.cs\n:\n//using Microsoft.Extensions.DependencyInjection;\nstatic class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        Application.SetHighDpiMode(HighDpiMode.SystemAware);\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n\n        var host = CreateHostBuilder().Build();\n        ServiceProvider = host.Services;\n\n        Application.Run(ServiceProvider.GetRequiredService<Form1>());\n    }\n    public static IServiceProvider ServiceProvider { get; private set; }\n    static IHostBuilder CreateHostBuilder()\n    {\n        return Host.CreateDefaultBuilder()\n            .ConfigureServices((context, services)=>{\n                services.AddTransient<IHelloService, HelloService>();\n                services.AddTransient<Form1>();\n            });\n    }\n}\nNow you can inject\nIHelloService\nin\nForm1\nand use it:\n//using Microsoft.Extensions.DependencyInjection;\npublic partial class Form1 : Form\n{\n    private readonly IHelloService helloService;\n\n    public Form1(IHelloService helloService)\n    {\n        InitializeComponent();\n        this.helloService = helloService;\n        MessageBox.Show(helloService.SayHello());\n    }\n}\nIf you want to show\nForm2\nusing DI, you first need to register it\nservices.AddTransient<Form2>();\n, then depending to the usage of Form2, you can use either of the following options:\nIf you only need a single instance of\nForm2\nin the whole life time of\nForm1\n, then you can inject it as a dependency to the constructor of\nForm1\nand store the instance and show it whenever you want.\nBut please pay attention: it will be initialized just once, when you open\nForm1\nand it will not be initialized again. You also should not dispose it, because it's the only instance passed to\nForm1\n.\npublic Form1(IHelloService helloService, Form2 form2)\n{ \n     InitializeComponent();\n         form2.ShowDialog();\n}\nIf you need multiple instances of\nForm2\nor you need to initialize it multiple times, then you may get an instance of it like this:\nusing (var form2 = Program.ServiceProvider.GetRequiredService<Form2>())\n     form2.ShowDialog();", "is_accepted": false, "answered_by": {"name": "Reza Aghaei", "user-profile-link": "https://stackoverflow.com/users/3110834/reza-aghaei", "answered_time": "Feb 16, 2022 at 1:18", "reputation": "125k", "gold": "18", "silver": "230", "bronze": "426"}}, {"content": "There's another approach than the one described by Reza in his answer. This answer of mine was\noriginally published on my blog\n, however, since Stack Overflow is the primary source of information for most of us, the blog post linked in a comment below Reza's answer could easily be missed.\nHere goes then. This solution is based on the\nLocal Factory\npattern.\nWe'll start with a form factory\npublic interface IFormFactory\n{\n    Form1 CreateForm1();\n    Form2 CreateForm2();\n}\n\npublic class FormFactory : IFormFactory\n{\n    static IFormFactory _provider;\n\n    public static void SetProvider( IFormFactory provider )\n    {\n        _provider = provider;\n    }\n\n    public Form1 CreateForm1()\n    {\n        return _provider.CreateForm1();\n    }\n\n    public Form2 CreateForm2()\n    {\n        return _provider.CreateForm2();\n    }\n}\nFrom now on, this factory is the primary client's interface to creating forms. The client code is no longer supposed to just call\nvar form1 = new Form1();\nNo, it's forbidden. Instead, the client should always call\nvar form1 = new FormFactory().CreateForm1();\n(and similarily for other forms).\nNote that while the factory is implemented, it doesn't do anything on its own! Instead it delegates the creation to a somehow mysterious provider which has to be injected into the factory. The idea behind this is that the provider will be injected, once, in the\nComposition Root\nwhich is a place in the code, close to the startup, and very high in the application stack so that all dependencies can be resolved there. So, the form factory doesn't need to know what provider will be ultimately injected into it.\nThis approach has a significant advantage - depending on actual requirements, different providers can be injected, for example you could have a DI-based provider (we'll write it in a moment) for an actual application and a stub provider for unit tests.\nAnyway, let's have a form with a dependency:\npublic partial class Form1 : Form\n{\n    private IHelloWorldService _service;\n\n    public Form1(IHelloWorldService service)\n    {\n        InitializeComponent();\n\n        this._service = service;\n    }\n}\nThis form depends on a service and the service will be provided by the constructor. If the Form1 needs to create another form, Form2, it does it it a way we already discussed:\nvar form2 = new FormFactory().CreateForm2();\nThings become more complicated, though, when a form needs not only dependant services but also, just some free parameters (strings, ints etc.). Normally, you'd have a constructor\npublic Form2( string something, int somethingElse ) ...\nbut now you need something more like\npublic Form2( ISomeService service1, IAnotherService service2, \n              string something, int somethingElse ) ...\nThis is something we should really take a look into. Look once again, a real-life form possibly needs\nHow do we handle that?\nTo have a complete example, let's then modify the form factory\npublic interface IFormFactory\n{\n    Form1 CreateForm1();\n    Form2 CreateForm2(string something);\n}\n\npublic class FormFactory : IFormFactory\n{\n    static IFormFactory _provider;\n\n    public static void SetProvider( IFormFactory provider )\n    {\n        _provider = provider;\n    }\n\n    public Form1 CreateForm1()\n    {\n        return _provider.CreateForm1();\n    }\n\n    public Form2 CreateForm2(string something)\n    {\n        return _provider.CreateForm2(something);\n    }\n}\nAnd let's see how forms are defined\npublic partial class Form1 : Form\n{\n    private IHelloWorldService _service;\n\n    public Form1(IHelloWorldService service)\n    {\n        InitializeComponent();\n\n        this._service = service;\n    }\n\n    private void button1_Click( object sender, EventArgs e )\n    {\n        var form2 = new FormFactory().CreateForm2(\"foo\");\n        form2.Show();\n    }\n}\n\npublic partial class Form2 : Form\n{\n    private IHelloWorldService _service;\n    private string _something;\n\n    public Form2(IHelloWorldService service, string something)\n    {\n        InitializeComponent();\n\n        this._service = service;\n        this._something = something;\n\n        this.Text = something;\n    }\n}\nCan you see a pattern here?\nNow finally to the\n. Let's start with the service\npublic interface IHelloWorldService\n{\n    string DoWork();\n}\n\npublic class HelloWorldServiceImpl : IHelloWorldService\n{\n    public string DoWork()\n    {\n        return \"hello world service::do work\";\n    }\n}\nNote that while the interface is supposed to be somewhere down in the stack (to be recognized by everyone), the implementation is free to be provided anywhere (forms don't need reference to the implementation!). Then, follows the starting code where the form factory is finally provided and the container is set up\ninternal static class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        var formFactory = CompositionRoot();\n\n        ApplicationConfiguration.Initialize();\n        Application.Run(formFactory.CreateForm1());\n    }\n\n    static IHostBuilder CreateHostBuilder()\n    {\n        return Host.CreateDefaultBuilder()\n            .ConfigureServices((context, services) => {\n                services.AddTransient<IHelloWorldService, HelloWorldServiceImpl>();\n                services.AddTransient<Form1>();\n                services.AddTransient<Func<string,Form2>>(\n                    container =>\n                        something =>\n                        {\n                            var helloWorldService = \n                                container.GetRequiredService<IHelloWorldService>();\n                            return new Form2(helloWorldService, something);\n                        });\n            });\n    }\n\n    static IFormFactory CompositionRoot()\n    {\n        // host\n        var hostBuilder = CreateHostBuilder();\n        var host = hostBuilder.Build();\n\n        // container\n        var serviceProvider = host.Services;\n\n        // form factory\n        var formFactory = new FormFactoryImpl(serviceProvider);\n        FormFactory.SetProvider(formFactory);\n\n        return formFactory;\n    }\n}\n\npublic class FormFactoryImpl : IFormFactory\n{\n    private IServiceProvider _serviceProvider;\n\n    public FormFactoryImpl(IServiceProvider serviceProvider)\n    {\n        this._serviceProvider = serviceProvider;\n    }\n\n    public Form1 CreateForm1()\n    {\n        return _serviceProvider.GetRequiredService<Form1>();\n    }\n\n    public Form2 CreateForm2(string something)\n    {\n        var _form2Factory = _serviceProvider.GetRequiredService<Func<string, Form2>>();\n        return _form2Factory( something );\n    }\n}\nFirst note how the container is created with Host.CreateDefaultBuilder, an easy task. Then note how services are registered and how forms are registered among other services.\nThis is straightforward for forms that don't have any dependencies, it's just\nservices.AddTransient<Form1>();\nHowever, if a form needs both services and free parameters, it's registered as ... form creation function, a Func of any free parameters that returns actual form. Take a look at this\nservices.AddTransient<Func<string,Form2>>(\n    container =>\n        something =>\n        {\n            var helloWorldService = container.GetRequiredService<IHelloWorldService>();\n            return new Form2(helloWorldService, something);\n        });\nThat's clever. We register a form factory function using one of registration mechanisms that itself uses a factory function (yes, a factory that uses another factory, a Factception. Feel free to take a short break if you feel lost here). Our registered function, the Func<string, Form2> has a single parameter, the something (that corresponds to the free parameter of the form constructor) but its other dependencies are resolved ... by the container (which is what we wanted).\nThis is why the actual form factory needs to pay attention of what it resolves. A simple form is resolved as follows\nreturn _serviceProvider.GetRequiredService<Form1>();\nwhere the other is resolved in two steps. We first resolve the factory function and then use the creation's method parameter to feed it to the function:\nvar _form2Factory = _serviceProvider.GetRequiredService<Func<string, Form2>>();\nreturn _form2Factory( something );\nAnd, that's it. Whenever a form is created, is either\nnew FormFactory().CreateForm1();\nfor \"simple\" forms (with service dependencies only) or just\nnew FormFactory().CreateForm2(\"foo\");\nfor forms that need both service dependncies and other free parameters.", "is_accepted": false, "answered_by": {"name": "Wiktor Zychla", "user-profile-link": "https://stackoverflow.com/users/941240/wiktor-zychla", "answered_time": "Aug 24, 2022 at 10:30", "reputation": "48.2k", "gold": "6", "silver": "79", "bronze": "111"}}, {"content": "Just wanted to add this here too as an alternative pattern for the IFormFactory. This is how I usually approach it.\nThe benefit is you don't need to keep changing your IFormFactory interface foreach form that you add and each set of parameters.\nLoad all forms when application starts and pass arguments to  the show method or some other base method you can define on your forms.\ninternal static class Program\n{\n    public static IServiceProvider ServiceProvider { get; private set; }\n  \n    [STAThread]\n    static void Main()\n    {\n        ApplicationConfiguration.Initialize();\n        ServiceProvider = CreateHostBuilder().Build().Services;\n        Application.Run(ServiceProvider.GetService<Form1>());\n    }\n   \n    static IHostBuilder CreateHostBuilder()\n    {\n        return Host.CreateDefaultBuilder()\n            .ConfigureServices((context, services) => {\n                services.AddSingleton<IFormFactory,FormFactory>();\n                services.AddSingleton<IProductRepository, ProductRepository>();\n\n                 //Add all forms\n                var forms = typeof(Program).Assembly\n                .GetTypes()\n                .Where(t => t.BaseType ==  typeof(Form))\n                .ToList();\n\n                forms.ForEach(form =>\n                {\n                    services.AddTransient(form);\n                });\n            });\n    }\n}\nForm Factory\npublic interface IFormFactory\n{\n    T? Create<T>() where T : Form;\n}\n\npublic class FormFactory : IFormFactory\n{\n    private readonly IServiceScope _scope;\n\n    public FormFactory(IServiceScopeFactory scopeFactory) \n    {\n        _scope = scopeFactory.CreateScope();\n    }\n\n    public T? Create<T>() where T : Form\n    {\n        return _scope.ServiceProvider.GetService<T>();\n    }\n}\nForm 1\npublic partial class Form1 : Form\n{\n    private readonly IFormFactory _formFactory;\n    public Form1(IFormFactory formFactory)\n    {\n        InitializeComponent();\n        _formFactory = formFactory;\n    }\n\n    private void button_Click(object sender, EventArgs e)\n    {\n        var form2 = _formFactory.Create<Form2>();\n        form2?.Show(99);\n    }\n}\nForm 2\npublic partial class Form2 : Form\n{\n    private readonly IProductRepository _productRepository;\n\n    public Form2(IProductRepository productRepository)\n    {\n        InitializeComponent();\n        _productRepository = productRepository;\n    }\n\n    public void Show(int recordId)\n    {\n        var product = _productRepository.GetProduct(recordId);\n\n        //Bind your controls etc\n        this.Show();\n    }\n}", "is_accepted": false, "answered_by": {"name": "TheBeast", "user-profile-link": "https://stackoverflow.com/users/2207784/thebeast", "answered_time": "Jan 16, 2023 at 19:09", "reputation": "305", "gold": "0", "silver": "3", "bronze": "6"}}, {"content": "How to use Dependency Injection in WinForms\nHere is a simple explanation about how to use DI in winforms .\nIn modern applications , DI allows us to delegate the creation of objects and their dependencies to a container . This helps keep your code loosely coupled , more maintainable .\nFirst you have to set up the DI container in your program.cs file . This container is responsible for creating instances of your services.\ninternal static class Program\n{\n    \n    [STAThread]\n    static void Main()\n    {\n        \n        ApplicationConfiguration.Initialize();\n        \n\n        //setting up the DI container\n        var services = new ServiceCollection();\n        //registering services\n        ConfigureServices(services);\n        //build the service provider\n        var servicesProvider = services.BuildServiceProvider();\n\n        ServiceProviderHolder.ServiceProvider = servicesProvider;\n        Application.Run(new Form1());\n    }\n\n    public static class ServiceProviderHolder\n    {\n        public static IServiceProvider ServiceProvider { get; set; }\n    }\n    private static void ConfigureServices(IServiceCollection services)\n    {\n        services.AddDbContext<ScheduleDBContext>();\n        services.AddTransient<AddMachine>();\n    }\n}\nNow when the program.cs file runs it builds the serviceprovider which knows how to create instances of all the services that is registered , along with their dependencies .\nThen when the program wants to create an instance of the addMachine form with a button click you do not have to create that instance manually because the service provider does that for you . It can identify and all the dependency's of the AddMachine class , create an instance of it including all the dependancies .\nHere in Form1.cs there is a button which generates an instance of the AddMachine form . And that AddMachine class has a dependancy on ScheduleDBContext .\nSo with the help of the DI container now we do not have to create an instance of ScheduleDBContex manually and pass it to the constructor of the AddMachine .\nHere is the AddMachine class .\npublic partial class AddMachine : Form\n{\n    private readonly ScheduleDBContext _scheduleDBContext;\n\n    public AddMachine(ScheduleDBContext scheduleDBContext)\n    {\n        _scheduleDBContext = scheduleDBContext;\n        InitializeComponent();         \n    }\nAnd the button click event on form1 which creates an instance of the AddMachine\nprivate void button1_Click(object sender, EventArgs e)\n{\n    var addMachineForm = ServiceProviderHolder.ServiceProvider.GetRequiredService<AddMachine>();\n    addMachineForm.Show();\n}\nHope someone finds this helpful .", "is_accepted": false, "answered_by": {"name": "Sahan Rajapaksha", "user-profile-link": "https://stackoverflow.com/users/21242894/sahan-rajapaksha", "answered_time": "Sep 19 at 17:51", "reputation": "1", "gold": "0", "silver": "0", "bronze": "2"}}, {"content": "As a complement to other answers: if the form is non-modal, you might want to\nDispose\nthe form dependencies when the form closes. In my case, one of the services is\nIDisposable\nso calling\nsomeForm.Show()\nand not disposing them meant they are cleaned up only when the process ends (which can be seen as a memory leak). I solved it by using the\nIComponent.Disposed\nevent\n.\n// Usage: Inject as `NonModalFormFactory<YourFormClass> yourFormFactory` to call `yourFormFactory.Make().Show()`.\nclass NonModalFormFactory<TForm>(IServiceScopeFactory ScopeFactory) where T : IComponent\n{\n    public TForm Make(params object?[]? constructorArgs)\n    {\n        // The scope will be disposed when the form does\n        IServiceScope scope = ScopeFactory.CreateScope();\n        TForm t = ActivatorUtilities.CreateInstance<TForm>(scope.ServiceProvider, constructorArgs);\n\n        t.Disposed += T_Disposed;\n\n        return t;\n\n        void T_Disposed(object? sender, EventArgs e)\n        {\n            using (scope) { ((IComponent)sender!).Disposed -= T_Disposed; }\n        }\n    }\n}", "is_accepted": false, "answered_by": {"name": "snipsnipsnip", "user-profile-link": "https://stackoverflow.com/users/188256/snipsnipsnip", "answered_time": "5 mins ago", "reputation": "2,555", "gold": "2", "silver": "37", "bronze": "37"}}]}